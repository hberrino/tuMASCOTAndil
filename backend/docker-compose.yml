services:

  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: tumascotandil-backend
    restart: unless-stopped
    ports:
      - "8080:8080"
    environment:
      SPRING_PROFILES_ACTIVE: prod
    
      # Variables de entorno para PostgreSQL (Supabase)
      # Configurar estas variables en Render o en tu entorno de producción
      # IMPORTANTE: No hardcodear credenciales aquí. Usar variables de entorno.
      DB_URL: ${DB_URL:-}
      DB_USERNAME: ${DB_USERNAME:-postgres}
      DB_PASSWORD: ${DB_PASSWORD:-}
      DB_DDL_AUTO: ${DB_DDL_AUTO:-update}
      DB_SHOW_SQL: ${DB_SHOW_SQL:-false}
      DB_FORMAT_SQL: ${DB_FORMAT_SQL:-false}
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
      ADMIN_USERNAME: ${ADMIN_USERNAME:-admin}
      ADMIN_PASSWORD: ${ADMIN_PASSWORD:-}
      ADMIN_CREATE_ON_STARTUP: ${ADMIN_CREATE_ON_STARTUP:-true}
    volumes:
      - ./uploads:/app/uploads
    networks:
      - tumascotandil-network

networks:
  tumascotandil-network:
    driver: bridge
